
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>ä» JVM ä¸­ dump class çš„å‡ ç§æ–¹æ³• - å°å¾„åˆ†å²”çš„èŠ±å›­</title>
  <meta name="author" content="khotyn">

  
  <meta name="description" content="">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://khotyn.github.com/blog/2013/08/03/dumping-class-from-jvm">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/bootstrap/bootstrap.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/stylesheets/bootstrap/responsive.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/stylesheets/syntax/syntax.css" media="screen, projection" rel="stylesheet" type="text/css">
  <style type="text/css">
    body {
      padding-bottom: 40px;
    }
    h1 {
      margin-bottom: 15px;
    }
    img {
      max-width: 100%;
    }
    .sharing, .meta, .pager {
      margin: 20px 0px 20px 0px;
    }
    .page-footer p {
      text-align: center;
    }
  </style>
  <script src="/javascripts/libs/jquery.js"></script>
  <script src="/javascripts/libs/modernizr-2.0.js"></script>
  <script src="/javascripts/libs/bootstrap.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="å°å¾„åˆ†å²”çš„èŠ±å›­" type="application/atom+xml">
  
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-44033767-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <nav role="navigation"><div class="navbar navbar-inverse">
  <div class="navbar-inner">
    <div class="container">
      <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </a>

      <a class="brand" href="/">å°å¾„åˆ†å²”çš„èŠ±å›­</a>

      <div class="nav-collapse">
        <ul class="nav">
  <li><a href="/blog/archives">ğŸ—‚å½’æ¡£</a></li>
  <li><a href="/about">ğŸ‘¨å…³äº</a></li>
  <li><a href="/hire">ğŸ‘¨â€ğŸ’»æ‹›è˜</a></li>
  <li><a href="https://github.com/khotyn" target="_blank">æˆ‘çš„ Github</a></li>
</ul>

        <ul class="nav pull-right" data-subscription="rss">
          <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
          
        </ul>

        
          <form class="pull-right navbar-search" action="https://google.com/search" method="get">
            <fieldset role="search">
              <input type="hidden" name="q" value="site:blog.khotyn.com" />
              <input class="search-query" type="text" name="q" results="0" placeholder="Search"/>
            </fieldset>
          </form>
        
      </div>
    </div>
  </div>
</div>
</nav>
  <div class="container">
    <div class="row-fluid">
      
<article class="hentry span9" role="article">

  
  <header class="page-header">
    
      <h1 class="entry-title">ä» JVM ä¸­ Dump Class çš„å‡ ç§æ–¹æ³•</h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-08-03T14:04:00-05:00" pubdate data-updated="true">Aug 3<span>rd</span>, 2013</time>
        
         | <a href="#disqus_thread">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><p>å‰å‡ å¤©åœ¨ HotCode çš„ç”¨æˆ·ç¾¤é‡Œé¢ï¼Œæœ‰åŒå­¦é—®èµ·â€œå¦‚ä½•å°† JVM ä¸­çš„ class dump å‡ºæ¥â€ï¼Œå½“æ—¶æˆ‘ä¸‹æ„è¯†çš„å›ç­”å°±æ˜¯â€œå¯ä»¥åœ¨ JVM å¯åŠ¨çš„æ—¶å€™æŒ‚ä¸€ä¸ª agent ä¸Šå»ï¼Œç„¶åé€šè¿‡ Instrumentation API åœ¨ class åŠ è½½çš„æ—¶å€™åšæ‹¦æˆªï¼ŒæŠŠç±» dump å‡ºæ¥ã€‚â€ï¼Œä»Šå¤©æ— èŠåœ¨ç¿» <a href="http://weibo.com/rednaxelafx">R å¤§</a>çš„<a href="http://rednaxelafx.iteye.com/blog/727938">åšå®¢</a>çš„æ—¶å€™ï¼Œå‘ç°è¿˜å¯ä»¥é€šè¿‡ sa-jdi.jar é‡Œé¢çš„ä¸€ä¸ªç±»åš dumpï¼Œè¿™é‡Œå°±é›†ä¸­ä»‹ç»ä¸€ä¸‹è¿™å‡ ä¸ªæ–¹æ³•ï¼Œç„¶åä»‹ç»æˆ‘åœ¨ sa-jdi.jar åŸºç¡€ä¸Šæ”¹çš„ä¸€ä¸ªå°å·¥å…·ã€‚</p>

<h3 id="classloadergetresourceasstream">é‡‡ç”¨ classLoader.getResourceAsStream()</h3>

<p>å°†ä¸€ä¸ªç±»ä» JVM ä¸­ dump å‡ºæ¥ï¼Œæœ€ç®€å•çš„æ–¹æ³•å½“ç„¶å°±æ˜¯ç›´æ¥ä» jar åŒ…ä¸­æŠŠå¯¹åº”çš„ class æ–‡ä»¶æ‰¾åˆ°ï¼Œç„¶å dump å‡ºæ¥äº†ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ <code>classLoader</code> çš„ <code>getResourceAsStream</code> æ¥åšï¼š</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="java"><span class="line"><span class="n">ClassLoader</span> <span class="n">loader</span> <span class="o">=</span> <span class="n">Thread</span><span class="o">.</span><span class="na">currentThread</span><span class="o">().</span><span class="na">getContextClassLoader</span><span class="o">();</span>
</span><span class="line"><span class="n">InputStream</span> <span class="n">in</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="na">getResourceAsStream</span><span class="o">(</span><span class="s">&quot;com/khotyn/Test.class&quot;</span><span class="o">);</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>æ‹¿åˆ° InputStream åï¼Œä½ å°±å¯ä»¥éšä¾¿ç©äº†ã€‚</p>

<p>è¿™ä¸ªæ–¹æ³•ç®€å•æ˜¯ç®€å•ï¼Œä½†æ˜¯ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œåœ¨æœ‰äº› Java ç¨‹åºä¸­ï¼Œç±»ä¸ä¸€å®šæ˜¯ä» Class æ–‡ä»¶ä¸­è¿‡æ¥ï¼Œæœ‰äº›æ˜¯åœ¨è¿è¡Œæ—¶ç”Ÿæˆçš„ï¼Œæœ‰äº›åˆ™åœ¨è½½å…¥åˆ° JVM ä¹‹å‰è¢«å¢å¼ºè¿‡ï¼Œæ‰€ä»¥è¿™ä¸ªæ–¹æ³•æœ‰äº›ç±»æ˜¯ dump ä¸å‡ºæ¥çš„ï¼Œæœ‰äº›ç±»åˆ™ dump å‡ºæ¥ä¸æ˜¯ä½ æƒ³è¦çš„ã€‚</p>

<h3 id="javaagent">é‡‡ç”¨ javaagent</h3>

<p>å¦å¤–ä¸€ä¸ªæ–¹æ³•æ˜¯é€šè¿‡åœ¨ JVM å¯åŠ¨çš„æ—¶å€™æŒ‚åœ¨ä¸€ä¸ª javaagentï¼Œç„¶åç”¨ Instrucmentation API åœ¨ç±»è¢«åŠ è½½åˆ°è™šæ‹Ÿæœºä¹‹å‰åšæ‹¦æˆªï¼Œå‚è€ƒä»£ç å¦‚ä¸‹ï¼š</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
<span class="line-number">27</span>
<span class="line-number">28</span>
<span class="line-number">29</span>
<span class="line-number">30</span>
<span class="line-number">31</span>
<span class="line-number">32</span>
<span class="line-number">33</span>
<span class="line-number">34</span>
<span class="line-number">35</span>
<span class="line-number">36</span>
</pre></td><td class="code"><pre><code class="java"><span class="line"><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">khotyn</span><span class="o">.</span><span class="na">test</span><span class="o">;</span>
</span><span class="line">
</span><span class="line"><span class="kn">import</span> <span class="nn">java.io.File</span><span class="o">;</span>
</span><span class="line"><span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
</span><span class="line"><span class="kn">import</span> <span class="nn">java.lang.instrument.ClassFileTransformer</span><span class="o">;</span>
</span><span class="line"><span class="kn">import</span> <span class="nn">java.lang.instrument.IllegalClassFormatException</span><span class="o">;</span>
</span><span class="line"><span class="kn">import</span> <span class="nn">java.lang.instrument.Instrumentation</span><span class="o">;</span>
</span><span class="line"><span class="kn">import</span> <span class="nn">java.security.ProtectionDomain</span><span class="o">;</span>
</span><span class="line">
</span><span class="line"><span class="kn">import</span> <span class="nn">org.apache.commons.io.FileUtils</span><span class="o">;</span>
</span><span class="line">
</span><span class="line"><span class="cm">/**</span>
</span><span class="line"><span class="cm"> * A demo to demonstrate how to use JVM ti to dump class file from JVM.</span>
</span><span class="line"><span class="cm"> * </span>
</span><span class="line"><span class="cm"> * @author khotyn.huangt 13-8-3 PM2:21</span>
</span><span class="line"><span class="cm"> */</span>
</span><span class="line"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">AgentMain</span> <span class="o">{</span>
</span><span class="line">
</span><span class="line">    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">premain</span><span class="o">(</span><span class="n">String</span> <span class="n">agentArgs</span><span class="o">,</span> <span class="n">Instrumentation</span> <span class="n">inst</span><span class="o">)</span> <span class="o">{</span>
</span><span class="line">        <span class="n">inst</span><span class="o">.</span><span class="na">addTransformer</span><span class="o">(</span><span class="k">new</span> <span class="n">ClassFileTransformer</span><span class="o">()</span> <span class="o">{</span>
</span><span class="line">
</span><span class="line">            <span class="nd">@Override</span>
</span><span class="line">            <span class="kd">public</span> <span class="kt">byte</span><span class="o">[]</span> <span class="nf">transform</span><span class="o">(</span><span class="n">ClassLoader</span> <span class="n">loader</span><span class="o">,</span> <span class="n">String</span> <span class="n">className</span><span class="o">,</span> <span class="n">Class</span><span class="o">&lt;?&gt;</span> <span class="n">classBeingRedefined</span><span class="o">,</span>
</span><span class="line">                                    <span class="n">ProtectionDomain</span> <span class="n">protectionDomain</span><span class="o">,</span> <span class="kt">byte</span><span class="o">[]</span> <span class="n">classfileBuffer</span><span class="o">)</span>
</span><span class="line">                                                                                              <span class="kd">throws</span> <span class="n">IllegalClassFormatException</span> <span class="o">{</span>
</span><span class="line">                <span class="k">try</span> <span class="o">{</span>
</span><span class="line">                    <span class="n">FileUtils</span><span class="o">.</span><span class="na">writeByteArrayToFile</span><span class="o">(</span><span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="s">&quot;/tmp/&quot;</span> <span class="o">+</span> <span class="n">className</span><span class="o">.</span><span class="na">replace</span><span class="o">(</span><span class="sc">&#39;.&#39;</span><span class="o">,</span> <span class="sc">&#39;/&#39;</span><span class="o">)</span> <span class="o">+</span> <span class="s">&quot;.class&quot;</span><span class="o">),</span>
</span><span class="line">                                                   <span class="n">classfileBuffer</span><span class="o">);</span>
</span><span class="line">                <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span><span class="line">                    <span class="c1">// Quite</span>
</span><span class="line">                <span class="o">}</span>
</span><span class="line">                <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
</span><span class="line">            <span class="o">}</span>
</span><span class="line">        <span class="o">});</span>
</span><span class="line">    <span class="o">}</span>
</span><span class="line"><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>å°†ä¸Šé¢çš„ä»£ç æ‰“æˆä¸€ä¸ª jar åŒ…ï¼ˆ<em>æ³¨æ„æŠŠä¾èµ–çš„ apache commons.io ä¹Ÿæ‰“å…¥ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä¸‹è½½æˆ‘çš„ demo å·¥ç¨‹ï¼š<a href="http://pan.baidu.com/share/link?shareid=778648109&amp;uk=607430891">agentDumpClass.zip</a></em>ï¼‰ï¼Œç„¶ååœ¨ jar åŒ…çš„ <code>META-INF/MANIFEST.MF</code> ä¸­å¡«ä¸Šå¦‚ä¸‹çš„å†…å®¹ï¼š</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
</pre></td><td class="code"><pre><code class="java"><span class="line"><span class="n">Manifest</span><span class="o">-</span><span class="nl">Version:</span> <span class="mf">1.0</span>
</span><span class="line"><span class="n">Boot</span><span class="o">-</span><span class="n">Class</span><span class="o">-</span><span class="nl">Path:</span> <span class="n">agentDump</span><span class="o">.</span><span class="na">jar</span>
</span><span class="line"><span class="n">Built</span><span class="o">-</span><span class="nl">By:</span> <span class="n">apple</span>
</span><span class="line"><span class="n">Build</span><span class="o">-</span><span class="nl">Jdk:</span> <span class="mf">1.7</span><span class="o">.</span><span class="mi">0</span><span class="n">_17</span>
</span><span class="line"><span class="n">Class</span><span class="o">-</span><span class="nl">Path:</span> <span class="n">lib</span><span class="o">/</span><span class="n">commons</span><span class="o">-</span><span class="n">io</span><span class="o">-</span><span class="mf">2.4</span><span class="o">.</span><span class="na">jar</span>
</span><span class="line"><span class="n">Premain</span><span class="o">-</span><span class="nl">Class:</span> <span class="n">com</span><span class="o">.</span><span class="na">khotyn</span><span class="o">.</span><span class="na">test</span><span class="o">.</span><span class="na">AgentMain</span>
</span><span class="line"><span class="n">Created</span><span class="o">-</span><span class="nl">By:</span> <span class="n">Apache</span> <span class="n">Maven</span>
</span><span class="line"><span class="n">Can</span><span class="o">-</span><span class="n">Redefine</span><span class="o">-</span><span class="nl">Classes:</span> <span class="kc">true</span>
</span><span class="line"><span class="n">Archiver</span><span class="o">-</span><span class="nl">Version:</span> <span class="n">Plexus</span> <span class="n">Archiver</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>ç„¶åä½ å°±å¯ä»¥æ‰§è¡Œç±»ä¼¼äºä¸‹é¢çš„å‘½ä»¤æ¥è¿›è¡Œ dump äº†ï¼š</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="java"><span class="line"><span class="n">java</span> <span class="o">-</span><span class="nl">javaagent:</span><span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">apple</span><span class="o">/</span><span class="n">workspace</span><span class="o">/</span><span class="n">agentDumpClass</span><span class="o">/</span><span class="n">target</span><span class="o">/</span><span class="n">agentDump</span><span class="o">.</span><span class="na">jar</span> <span class="n">Test</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>ç”±äº premain æ–¹æ³•æ˜¯åœ¨ java ç¨‹åºçš„ main æ–¹æ³•æ‰§è¡Œä¹‹å‰æ‰§è¡Œçš„ï¼Œæ‰€ä»¥è¿™ä¸ªæ–¹æ³•å‡ ä¹å¯ä»¥æ‹¦æˆªåˆ°æ‰€æœ‰çš„ç±»ï¼Œå¦å¤–ï¼Œç”±äºæ³¨å†Œçš„ ClassFileTransformer æ˜¯ ClassLoader åŠ è½½ class ä¹‹åï¼ŒJVM å®šä¹‰ class ä¹‹å‰è¢«æ‰§è¡Œçš„ï¼Œæ‰€ä»¥æ— è®ºæ˜¯åœ¨è¿è¡Œæ—¶ç”Ÿæˆçš„ç±»ï¼Œè¿˜æ˜¯ç»è¿‡å¢å¼ºåçš„ç±»ï¼Œè¿™ä¸ªæ–¹æ³•éƒ½èƒ½å¤Ÿ dump å‡ºæ¥ï¼Œæ¯”ç¬¬ä¸€ç§æ–¹æ³•è¦å¼ºå¾ˆå¤šã€‚ç„¶è€Œè¿™ä¸ªæ–¹æ³•è¿˜æ˜¯æœ‰ä¸€äº›ç¼ºç‚¹ï¼š</p>

<ul>
  <li>éœ€è¦åœ¨ JVM å¯åŠ¨æ—¶å¢åŠ ç‰¹åˆ«çš„å‚æ•°ã€‚</li>
  <li>åªèƒ½éš class è¢«åŠ è½½è¿›è¡Œ dumpï¼Œä¸èƒ½éšæ—¶è¿›è¡Œ dump</li>
</ul>

<h3 id="sa-jdijar--classdump-">é‡‡ç”¨ sa-jdi.jar çš„ ClassDump å·¥å…·</h3>

<p>è¿™ä¸ªæ–¹å¼æ˜¯ R å¤§åœ¨åšå®¢ä¸­ä»‹ç»çš„æ–¹æ³•ï¼Œå¯ä»¥è¯´æ˜¯æœ€å¼ºå¤§çš„æ–¹æ³•ï¼Œä¸åƒå‰é¢çš„ä¸¤ä¸ªæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•å¯ä»¥åœ¨ JVM è¿›ç¨‹å¤–æ‰§è¡Œï¼Œä¸”åƒ javaagent çš„é‚£ä¸ªæ–¹æ³•ä¸€æ ·ï¼Œéƒ½å¯ä»¥å°†è¿è¡Œæ—¶å’Œè¢«å¢å¼ºè¿‡çš„ç±» dump å‡ºæ¥ï¼Œéå¸¸æ–¹ä¾¿ï¼Œè‡³äºå…·ä½“çš„ç”¨æ³•å¤§å®¶å°±ç›´æ¥çœ‹ <a href="http://rednaxelafx.iteye.com/blog/727938">R å¤§çš„æ–‡ç« </a>å§ã€‚</p>

<h3 id="classdump">æ”¹è¿› ClassDump</h3>

<p>ClassDump å·¥å…·è™½ç„¶å¼ºå¤§ï¼Œä½†æ˜¯å‘½ä»¤ç•¥æ˜¾ç¹çï¼Œç‰¹åˆ«æ˜¯å½“ä½ åªéœ€è¦ dump ç‰¹å®šçš„ç±»çš„æ—¶å€™ï¼Œè¿˜éœ€è¦ä¸“é—¨å†™ä¸€ä¸ª ClassFilter çš„å®ç°ç±»ï¼Œè¿™ä¹ˆå¥½çš„å·¥å…·ï¼Œåº”è¯¥ç›´æ¥åšæˆå‘½ä»¤è¡Œå·¥å…·æ‰å¥½ï¼Œäºæ˜¯æˆ‘ä¿®æ”¹äº† ClassDump çš„ä»£ç ï¼Œè®©å®ƒå¯ä»¥æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼çš„æ–¹å¼æ¥å¯¹éœ€è¦ dump çš„ç±»è¿›è¡Œè¿‡æ»¤ï¼Œæ”¹è¿›åçš„ ClassDump æ”¾åœ¨äº†æˆ‘çš„ github ä»“åº“ä¸Šï¼š<a href="https://github.com/khotyn/tools">https://github.com/khotyn/tools</a></p>

<p>å¤§å®¶å¯ä»¥ç›´æ¥ç”¨ä¸‹é¢çš„æ–¹å¼æ¥ä½¿ç”¨è¿™ä¸ªæ”¹è¿›ç‰ˆï¼š</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="java"><span class="line"><span class="n">sudo</span> <span class="n">classDump</span> <span class="mi">17118</span> <span class="err">&#39;</span><span class="n">com</span><span class="o">.</span><span class="na">khotyn</span><span class="o">.*</span><span class="err">&#39;</span> <span class="n">dump</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>classDump è¿™ä¸ªå‘½ä»¤çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç›®æ ‡ JVM çš„ PIDï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œè¡¨ç¤ºä½ æ‰€è¦ Dump å‡ºæ¥çš„ç±»ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°å¯é€‰ï¼Œæ˜¯ dump çš„ç›®å½•ã€‚</p>

<p>ä½†æ˜¯è¿™ä¸ªå·¥å…·æœ‰ä¸€ä¸ªç¼ºç‚¹ï¼Œå°±æ˜¯ç›®å‰åªèƒ½åœ¨ Mac ä¸‹ç”¨ï¼ˆå› ä¸ºæˆ‘ç”¨ Macï¼Œå‘µå‘µï¼Œæˆ‘æŠŠä¿®æ”¹åçš„ç±»ç›´æ¥æ‰“å…¥åˆ°äº† Mac çš„ jdk çš„ sa-jdi.jar ä¸‹é¢ï¼‰ï¼Œä¸è¿‡è¦åšå…¶ä»–çš„å¹³å°çš„ä¹Ÿå¾ˆç®€å•å•¦ï¼Œåªè¦æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ¥æ‰“åŒ…å‡ºè‡ªå·±çš„ sa-jdi.jar å°±å¯ä»¥ï¼š</p>

<ul>
  <li>ä¸‹è½½æˆ‘ä¿®æ”¹è¿‡çš„ä¸¤ä¸ªç±»ï¼š<a href="http://pan.baidu.com/share/link?shareid=780474506&amp;uk=607430891">ClassDump.class</a>ï¼Œ<a href="http://pan.baidu.com/share/link?shareid=782905423&amp;uk=607430891">RegexClassFilter.class</a></li>
  <li>ä» jdk ç›®å½•ä¸‹æ‹·è´ä¸€ä»½ sa-jdi.jar å‡ºæ¥</li>
  <li>ç”¨ä¸‹é¢çš„å‘½ä»¤å°†ä¿®æ”¹è¿‡çš„ä¸¤ä¸ªç±»æ‰“åˆ° sa-jdi.jar ä¸­å»ï¼š<code>jar uf sa-jdi.jar sun/jvm/hotspot/tools/jcore/ClassDump.class sun/jvm/hotspot/tools/jcore/RegexClassFilter.class</code></li>
  <li>ç„¶åé…åˆä»“åº“ä¸­çš„ classDump è„šæœ¬å°±å¯ä»¥ç”¨äº†ã€‚</li>
</ul>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">khotyn</span></span>

      








  


<time datetime="2013-08-03T14:04:00-05:00" pubdate data-updated="true">Aug 3<span>rd</span>, 2013</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/jvm/'>JVM</a>, <a class='category' href='/blog/categories/java/'>Java</a>, <a class='category' href='/blog/categories/programming/'>Programming</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  
  
</div>

    
    
    <section>
      <h1>Comments</h1>
      <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
    </section>
    
    <ul class="pager">
      
      <li class="previous"><a class="basic-alignment left"
        href="/blog/2013/07/30/sed-part-two/" title="Previous Post:
        ã€ŒSed & Awkã€é˜…è¯»ç¬”è®°ä¹‹ Sed é«˜çº§å‘½ä»¤">&laquo; ã€ŒSed & Awkã€é˜…è¯»ç¬”è®°ä¹‹ Sed é«˜çº§å‘½ä»¤</a></li>
      
      <li><a href="/blog/archives">Blog Archives</a></li>
      
      <li class="next"><a class="basic-alignment right" href="/blog/2013/09/14/spring-tx-propagation/"
        title="Next Post: Spring äº‹åŠ¡çš„ä¼ æ’­ç‰¹æ€§">Spring äº‹åŠ¡çš„ä¼ æ’­ç‰¹æ€§
        &raquo;</a></li>
      
    </ul>
  </footer>
</article>

<aside class="sidebar-nav span3">
  
    <section class="well">
  <ul id="recent_posts" class="nav nav-list">
    <li class="nav-header">Recent Posts</li>
    
      <li class="post">
        <a href="/blog/2019/10/08/jdk13-dynamic-cds/">JDK13 æ–°ç‰¹æ€§ä¹‹ Dynamic CDS</a>
      </li>
    
      <li class="post">
        <a href="/blog/2019/10/06/new-zealand/">æ–°è¥¿å…°æ¸¸è®°</a>
      </li>
    
      <li class="post">
        <a href="/blog/2019/10/06/the-legend-of-heroes-4/">é—ªä¹‹è½¨è¿¹ 4 ç©åæ„Ÿ</a>
      </li>
    
      <li class="post">
        <a href="/blog/2018/03/24/springboot-on-kubernetes/">SpringBoot on Kubernetes</a>
      </li>
    
      <li class="post">
        <a href="/blog/2018/03/21/app-cds/">Java 10 æ–°ç‰¹æ€§ä¹‹ AppCDS</a>
      </li>
    
  </ul>
</section>

<section class="well">
  <ul id="gh_repos" class="nav">
    <li class="nav-header">GitHub Repos</li>
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/khotyn">@khotyn</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        github.showRepos({
            user: 'khotyn',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/asides/github.js" type="text/javascript"> </script>
</section>






  
</aside>


    </div>
  </div>
  <footer role="contentinfo" class="page-footer"><hr>
<p>
  Copyright &copy; 2019 - khotyn -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'khotynblog';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://khotyn.github.com/blog/2013/08/03/dumping-class-from-jvm/';
        var disqus_url = 'http://khotyn.github.com/blog/2013/08/03/dumping-class-from-jvm/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>











</body>
</html>
